<!--pages/personal-info/personal-info.wxml-->
<view class="personal-info-container">
  <!-- å¤´åƒåŒºåŸŸ -->
  <view class="avatar-section">
    <view class="avatar-wrapper" bindtap="onChooseAvatar">
      <image 
        class="user-avatar"
        src="{{formData.avatar || 'https://via.placeholder.com/120x120/E0E0E0/999999?text=å¤´åƒ'}}"
        mode="aspectFill"
      />
      <view class="avatar-overlay">ğŸ“·</view>
      <view class="upload-loading" wx:if="{{uploading}}">ä¸Šä¼ ä¸­...</view>
    </view>
    <view class="avatar-tip">ç‚¹å‡»æ›´æ¢å¤´åƒ</view>
  </view>

  <!-- åŸºæœ¬ä¿¡æ¯è¡¨å• -->
  <view class="form-section">
    <view class="form-group">
      <view class="form-item">
        <view class="form-label">å§“å *</view>
        <input
          class="form-input"
          value="{{formData.name}}"
          placeholder="è¯·è¾“å…¥çœŸå®å§“å"
          bindinput="onInputChange"
          data-field="name"
        />
      </view>

      <view class="form-item">
        <view class="form-label">æ€§åˆ« *</view>
        <picker bindchange="onGenderChange" value="{{genderIndex}}" range="{{genderOptions}}">
          <view class="picker-input">
            {{formData.gender ? (formData.gender === 'male' ? 'ç”·' : 'å¥³') : 'è¯·é€‰æ‹©æ€§åˆ«'}}
          </view>
        </picker>
      </view>

      <view class="form-item">
        <view class="form-label">å¹´é¾„ *</view>
        <input
          class="form-input"
          value="{{formData.age}}"
          placeholder="è¯·è¾“å…¥å¹´é¾„"
          type="number"
          bindinput="onInputChange"
          data-field="age"
        />
      </view>

      <view class="form-item">
        <view class="form-label">æ‰‹æœºå· *</view>
        <input
          class="form-input"
          value="{{formData.phone}}"
          placeholder="è¯·è¾“å…¥æ‰‹æœºå·"
          type="number"
          maxlength="11"
          bindinput="onInputChange"
          data-field="phone"
        />
      </view>

      <view class="form-item">
        <view class="form-label">é‚®ç®±</view>
        <input
          class="form-input"
          value="{{formData.email}}"
          placeholder="è¯·è¾“å…¥é‚®ç®±ï¼ˆé€‰å¡«ï¼‰"
          bindinput="onInputChange"
          data-field="email"
        />
      </view>

      <view class="form-item">
        <view class="form-label">å±…ä½åœ°å€</view>
        <input
          class="form-input"
          value="{{formData.address}}"
          placeholder="è¯·è¾“å…¥å±…ä½åœ°å€"
          bindinput="onInputChange"
          data-field="address"
        />
      </view>

      <view class="form-item">
        <view class="form-label">ç´§æ€¥è”ç³»äºº</view>
        <input
          class="form-input"
          value="{{formData.emergencyContact}}"
          placeholder="è¯·è¾“å…¥ç´§æ€¥è”ç³»äººå§“å"
          bindinput="onInputChange"
          data-field="emergencyContact"
        />
      </view>

      <view class="form-item">
        <view class="form-label">ç´§æ€¥è”ç³»ç”µè¯</view>
        <input
          class="form-input"
          value="{{formData.emergencyPhone}}"
          placeholder="è¯·è¾“å…¥ç´§æ€¥è”ç³»äººç”µè¯"
          type="number"
          maxlength="11"
          bindinput="onInputChange"
          data-field="emergencyPhone"
        />
      </view>
    </view>
  </view>

  <!-- ä¸ªäººç®€ä»‹ -->
  <view class="intro-section">
    <view class="section-title">ä¸ªäººç®€ä»‹</view>
    <textarea
      class="intro-textarea"
      value="{{formData.introduction}}"
      placeholder="è¯·ç®€å•ä»‹ç»ä¸€ä¸‹è‡ªå·±çš„å·¥ä½œç»éªŒå’ŒæŠ€èƒ½ç‰¹é•¿..."
      maxlength="200"
      bindinput="onInputChange"
      data-field="introduction"
    />
    <view class="char-count">{{formData.introduction.length || 0}}/200</view>
  </view>

  <!-- é”™è¯¯æç¤º -->
  <view class="errors-section" wx:if="{{Object.keys(errors).length > 0}}">
    <view class="error-item" wx:for="{{errors}}" wx:key="index">
      <text class="error-text">âŒ {{item}}</text>
    </view>
  </view>

  <!-- ä¿å­˜æŒ‰é’® -->
  <view class="save-section">
    <button
      class="save-btn {{loading ? 'loading' : ''}}"
      disabled="{{loading}}"
      bindtap="onSave"
    >
      {{loading ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜ä¿¡æ¯'}}
    </button>
  </view>
</view>