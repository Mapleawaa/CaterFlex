<!--pages/company-publish/company-publish.wxml-->
<view class="publish-container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <view class="header-title">å‘å¸ƒç”¨å·¥éœ€æ±‚</view>
    <view class="header-desc">è¯¦ç»†æè¿°æ‚¨çš„ç”¨å·¥éœ€æ±‚ï¼Œç³»ç»Ÿå°†ä¸ºæ‚¨æ™ºèƒ½åŒ¹é…åˆé€‚çš„äººå‘˜</view>
  </view>

  <!-- åŸºæœ¬ä¿¡æ¯ -->
  <view class="form-section">
    <view class="section-title">
      <text class="title-icon">ğŸ“‹</text>
      <text class="title-text">åŸºæœ¬ä¿¡æ¯</text>
    </view>
    
    <view class="form-group">
      <view class="form-label">å²—ä½åç§° <text class="required">*</text></view>
      <input 
        class="form-input" 
        placeholder="è¯·è¾“å…¥å²—ä½åç§°ï¼Œå¦‚ï¼šæœåŠ¡å‘˜ã€å¨å¸ˆåŠ©ç†"
        value="{{formData.title}}"
        bindinput="onInputChange"
        data-field="title"
      />
    </view>

    <view class="form-group">
      <view class="form-label">å²—ä½ç±»å‹ <text class="required">*</text></view>
      <view class="picker-wrapper">
        <picker 
          mode="selector" 
          range="{{jobTypes}}" 
          range-key="name"
          value="{{formData.jobTypeIndex}}"
          bindchange="onJobTypeChange"
        >
          <view class="picker-display">
            <text class="picker-text">{{jobTypes[formData.jobTypeIndex].name || 'è¯·é€‰æ‹©å²—ä½ç±»å‹'}}</text>
            <text class="picker-arrow">></text>
          </view>
        </picker>
      </view>
    </view>

    <view class="form-group">
      <view class="form-label">å·¥ä½œåœ°ç‚¹ <text class="required">*</text></view>
      <view class="location-input">
        <input 
          class="form-input location-text" 
          placeholder="è¯·è¾“å…¥è¯¦ç»†åœ°å€"
          value="{{formData.location}}"
          bindinput="onInputChange"
          data-field="location"
        />
        <button class="location-btn" bindtap="onSelectLocation">
          <text class="bi bi-geo-alt"></text>
          å®šä½
        </button>
      </view>
    </view>

    <view class="form-group">
      <view class="form-label">è–ªèµ„å¾…é‡ <text class="required">*</text></view>
      <view class="salary-input">
        <input 
          class="form-input salary-amount" 
          type="number"
          placeholder="é‡‘é¢"
          value="{{formData.salary}}"
          bindinput="onInputChange"
          data-field="salary"
        />
        <picker 
          mode="selector" 
          range="{{salaryUnits}}" 
          value="{{formData.salaryUnitIndex}}"
          bindchange="onSalaryUnitChange"
        >
          <view class="salary-unit">
            <text>{{salaryUnits[formData.salaryUnitIndex] || 'å•ä½'}}</text>
            <text class="picker-arrow">></text>
          </view>
        </picker>
      </view>
    </view>
  </view>

  <!-- å·¥ä½œæ—¶é—´ -->
  <view class="form-section">
    <view class="section-title">
      <text class="title-icon">â°</text>
      <text class="title-text">å·¥ä½œæ—¶é—´</text>
    </view>

    <view class="form-group">
      <view class="form-label">å·¥ä½œæ—¥æœŸ <text class="required">*</text></view>
      <view class="date-range">
        <picker 
          mode="date" 
          value="{{formData.startDate}}"
          bindchange="onStartDateChange"
        >
          <view class="date-picker">
            <text>{{formData.startDate || 'å¼€å§‹æ—¥æœŸ'}}</text>
            <text class="bi bi-calendar"></text>
          </view>
        </picker>
        <text class="date-separator">è‡³</text>
        <picker 
          mode="date" 
          value="{{formData.endDate}}"
          bindchange="onEndDateChange"
        >
          <view class="date-picker">
            <text>{{formData.endDate || 'ç»“æŸæ—¥æœŸ'}}</text>
            <text class="bi bi-calendar"></text>
          </view>
        </picker>
      </view>
    </view>

    <view class="form-group">
      <view class="form-label">å·¥ä½œæ—¶æ®µ <text class="required">*</text></view>
      <view class="time-range">
        <picker 
          mode="time" 
          value="{{formData.startTime}}"
          bindchange="onStartTimeChange"
        >
          <view class="time-picker">
            <text>{{formData.startTime || 'å¼€å§‹æ—¶é—´'}}</text>
            <text class="bi bi-clock"></text>
          </view>
        </picker>
        <text class="time-separator">è‡³</text>
        <picker 
          mode="time" 
          value="{{formData.endTime}}"
          bindchange="onEndTimeChange"
        >
          <view class="time-picker">
            <text>{{formData.endTime || 'ç»“æŸæ—¶é—´'}}</text>
            <text class="bi bi-clock"></text>
          </view>
        </picker>
      </view>
    </view>

    <view class="form-group">
      <view class="form-label">å·¥ä½œæ¨¡å¼</view>
      <view class="work-mode-options">
        <view 
          class="mode-option {{formData.workMode === 'full-time' ? 'active' : ''}}"
          bindtap="onWorkModeChange"
          data-mode="full-time"
        >
          <text class="mode-icon">ğŸ•˜</text>
          <text class="mode-text">å…¨èŒ</text>
        </view>
        <view 
          class="mode-option {{formData.workMode === 'part-time' ? 'active' : ''}}"
          bindtap="onWorkModeChange"
          data-mode="part-time"
        >
          <text class="mode-icon">â°</text>
          <text class="mode-text">å…¼èŒ</text>
        </view>
        <view 
          class="mode-option {{formData.workMode === 'temporary' ? 'active' : ''}}"
          bindtap="onWorkModeChange"
          data-mode="temporary"
        >
          <text class="mode-icon">ğŸ“…</text>
          <text class="mode-text">ä¸´æ—¶</text>
        </view>
      </view>
    </view>
  </view>

  <!-- äººå‘˜è¦æ±‚ -->
  <view class="form-section">
    <view class="section-title">
      <text class="title-icon">ğŸ‘¥</text>
      <text class="title-text">äººå‘˜è¦æ±‚</text>
    </view>

    <view class="form-group">
      <view class="form-label">æ‹›è˜äººæ•° <text class="required">*</text></view>
      <view class="number-input">
        <button class="number-btn" bindtap="onNumberChange" data-field="recruitCount" data-action="decrease">-</button>
        <input 
          class="number-value" 
          type="number"
          value="{{formData.recruitCount}}"
          bindinput="onInputChange"
          data-field="recruitCount"
        />
        <button class="number-btn" bindtap="onNumberChange" data-field="recruitCount" data-action="increase">+</button>
        <text class="number-unit">äºº</text>
      </view>
    </view>

    <view class="form-group">
      <view class="form-label">å¹´é¾„è¦æ±‚</view>
      <view class="age-range">
        <input 
          class="age-input" 
          type="number"
          placeholder="æœ€å°"
          value="{{formData.minAge}}"
          bindinput="onInputChange"
          data-field="minAge"
        />
        <text class="age-separator">-</text>
        <input 
          class="age-input" 
          type="number"
          placeholder="æœ€å¤§"
          value="{{formData.maxAge}}"
          bindinput="onInputChange"
          data-field="maxAge"
        />
        <text class="age-unit">å²</text>
      </view>
    </view>

    <view class="form-group">
      <view class="form-label">æ€§åˆ«è¦æ±‚</view>
      <view class="gender-options">
        <view 
          class="gender-option {{formData.gender === 'unlimited' ? 'active' : ''}}"
          bindtap="onGenderChange"
          data-gender="unlimited"
        >
          ä¸é™
        </view>
        <view 
          class="gender-option {{formData.gender === 'male' ? 'active' : ''}}"
          bindtap="onGenderChange"
          data-gender="male"
        >
          ç”·æ€§
        </view>
        <view 
          class="gender-option {{formData.gender === 'female' ? 'active' : ''}}"
          bindtap="onGenderChange"
          data-gender="female"
        >
          å¥³æ€§
        </view>
      </view>
    </view>

    <view class="form-group">
      <view class="form-label">ç»éªŒè¦æ±‚</view>
      <view class="experience-options">
        <view 
          class="exp-option {{formData.experience === 'none' ? 'active' : ''}}"
          bindtap="onExperienceChange"
          data-exp="none"
        >
          æ— ç»éªŒ
        </view>
        <view 
          class="exp-option {{formData.experience === 'some' ? 'active' : ''}}"
          bindtap="onExperienceChange"
          data-exp="some"
        >
          æœ‰ç»éªŒä¼˜å…ˆ
        </view>
        <view 
          class="exp-option {{formData.experience === 'required' ? 'active' : ''}}"
          bindtap="onExperienceChange"
          data-exp="required"
        >
          å¿…é¡»æœ‰ç»éªŒ
        </view>
      </view>
    </view>

    <view class="form-group">
      <view class="form-label">æŠ€èƒ½è¦æ±‚</view>
      <view class="skills-input">
        <view class="skills-tags">
          <view 
            class="skill-tag"
            wx:for="{{formData.requiredSkills}}"
            wx:key="*this"
          >
            <text>{{item}}</text>
            <text class="remove-skill" bindtap="onRemoveSkill" data-skill="{{item}}">Ã—</text>
          </view>
        </view>
        <view class="add-skill">
          <input 
            class="skill-input" 
            placeholder="è¾“å…¥æŠ€èƒ½è¦æ±‚ï¼Œå›è½¦æ·»åŠ "
            value="{{newSkill}}"
            bindinput="onSkillInput"
            bindconfirm="onAddSkill"
          />
          <button class="add-skill-btn" bindtap="onAddSkill">æ·»åŠ </button>
        </view>
      </view>
    </view>
  </view>

  <!-- å·¥ä½œæè¿° -->
  <view class="form-section">
    <view class="section-title">
      <text class="title-icon">ğŸ“</text>
      <text class="title-text">å·¥ä½œæè¿°</text>
    </view>

    <view class="form-group">
      <view class="form-label">å·¥ä½œå†…å®¹ <text class="required">*</text></view>
      <textarea 
        class="form-textarea" 
        placeholder="è¯·è¯¦ç»†æè¿°å·¥ä½œå†…å®¹ã€èŒè´£å’Œè¦æ±‚..."
        value="{{formData.description}}"
        bindinput="onInputChange"
        data-field="description"
        maxlength="500"
      />
      <view class="char-count">{{formData.description.length}}/500</view>
    </view>

    <view class="form-group">
      <view class="form-label">ç¦åˆ©å¾…é‡</view>
      <view class="benefits-options">
        <view 
          class="benefit-item {{item.selected ? 'selected' : ''}}"
          wx:for="{{benefitOptions}}"
          wx:key="id"
          bindtap="onBenefitToggle"
          data-id="{{item.id}}"
        >
          <text class="benefit-icon">{{item.icon}}</text>
          <text class="benefit-text">{{item.name}}</text>
          <text class="benefit-check">{{item.selected ? 'âœ“' : ''}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç´§æ€¥ç¨‹åº¦ -->
  <view class="form-section">
    <view class="section-title">
      <text class="title-icon">ğŸš¨</text>
      <text class="title-text">ç´§æ€¥ç¨‹åº¦</text>
    </view>

    <view class="urgency-options">
      <view 
        class="urgency-item {{formData.urgency === 'low' ? 'active' : ''}}"
        bindtap="onUrgencyChange"
        data-urgency="low"
      >
        <view class="urgency-indicator low"></view>
        <view class="urgency-info">
          <text class="urgency-title">æ™®é€š</text>
          <text class="urgency-desc">3-7å¤©å†…åˆ°å²—</text>
        </view>
      </view>
      <view 
        class="urgency-item {{formData.urgency === 'medium' ? 'active' : ''}}"
        bindtap="onUrgencyChange"
        data-urgency="medium"
      >
        <view class="urgency-indicator medium"></view>
        <view class="urgency-info">
          <text class="urgency-title">ç´§æ€¥</text>
          <text class="urgency-desc">1-2å¤©å†…åˆ°å²—</text>
        </view>
      </view>
      <view 
        class="urgency-item {{formData.urgency === 'high' ? 'active' : ''}}"
        bindtap="onUrgencyChange"
        data-urgency="high"
      >
        <view class="urgency-indicator high"></view>
        <view class="urgency-info">
          <text class="urgency-title">éå¸¸ç´§æ€¥</text>
          <text class="urgency-desc">ä»Šå¤©å°±è¦åˆ°å²—</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section">
    <button class="preview-btn" bindtap="onPreview">é¢„è§ˆ</button>
    <button class="publish-btn" bindtap="onPublish" disabled="{{publishing}}">
      {{publishing ? 'å‘å¸ƒä¸­...' : 'ç«‹å³å‘å¸ƒ'}}
    </button>
  </view>

  <!-- é¢„è§ˆå¼¹çª— -->
  <view class="preview-modal {{showPreview ? 'show' : ''}}" wx:if="{{showPreview}}">
    <view class="modal-mask" bindtap="onClosePreview"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">å²—ä½é¢„è§ˆ</text>
        <text class="modal-close" bindtap="onClosePreview">Ã—</text>
      </view>
      <scroll-view class="modal-body" scroll-y="true">
        <view class="preview-job-card">
          <view class="job-header">
            <view class="job-title">{{formData.title}}</view>
            <view class="job-salary">{{formData.salary}}å…ƒ/{{salaryUnits[formData.salaryUnitIndex]}}</view>
          </view>
          <view class="job-info">
            <view class="info-item">
              <text class="info-label">å·¥ä½œåœ°ç‚¹ï¼š</text>
              <text class="info-value">{{formData.location}}</text>
            </view>
            <view class="info-item">
              <text class="info-label">å·¥ä½œæ—¶é—´ï¼š</text>
              <text class="info-value">{{formData.startDate}} è‡³ {{formData.endDate}}</text>
            </view>
            <view class="info-item">
              <text class="info-label">å·¥ä½œæ—¶æ®µï¼š</text>
              <text class="info-value">{{formData.startTime}} - {{formData.endTime}}</text>
            </view>
            <view class="info-item">
              <text class="info-label">æ‹›è˜äººæ•°ï¼š</text>
              <text class="info-value">{{formData.recruitCount}}äºº</text>
            </view>
          </view>
          <view class="job-description">{{formData.description}}</view>
        </view>
      </scroll-view>
      <view class="modal-footer">
        <button class="modal-btn cancel" bindtap="onClosePreview">ç»§ç»­ç¼–è¾‘</button>
        <button class="modal-btn confirm" bindtap="onConfirmPublish">ç¡®è®¤å‘å¸ƒ</button>
      </view>
    </view>
  </view>
</view>